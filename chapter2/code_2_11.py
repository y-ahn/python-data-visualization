# ============================================================
#  코드 2-11  groupby를 사용한 그룹별 집계
#  실행: python code_2_11.py
# ============================================================

import pandas as pd

# 여러 자치구 · 여러 달 데이터
apt_df = pd.DataFrame({
    '자치구':  ['강남구','강남구','강남구','서초구','서초구','마포구','마포구'],
    '월':      [1, 2, 3, 1, 2, 1, 2],
    '거래금액': [120000, 125000, 123000, 115000, 118000, 80000, 82000],
    '거래건수': [80, 92, 85, 65, 70, 50, 55],
})

# 단일 컬럼 groupby
print('=== 자치구별 평균 거래금액 ===')
print(apt_df.groupby('자치구')['거래금액'].mean().round(0))
print()

# 복수 집계 함수
print('=== 자치구별 통계 ===')
print(apt_df.groupby('자치구')['거래금액'].agg(['mean', 'min', 'max']).round(0))
print()

# 다중 컬럼 groupby
print('=== 자치구 · 월별 합계 ===')
print(apt_df.groupby(['자치구', '월'])['거래건수'].sum())
